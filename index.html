<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ููู ุฅูุฌุงุฒ ุงููุนููุฉ ูุฑูุงู ุงูุบูุงุฑู</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700&display=swap" rel="stylesheet">
    
    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.8.0/firebase-firestore-compat.js"></script>
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    
    <style>
        /* ุฅุถุงูุฉ ุฃููุงุท ุฅุถุงููุฉ */
        .data-management {
            margin-top: 20px;
            padding: 20px;
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
        }
        
        .storage-info {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        
        .storage-item {
            flex: 1;
            min-width: 200px;
            padding: 15px;
            background: var(--light-gray);
            border-radius: 10px;
            text-align: center;
        }
        
        .storage-item h4 {
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .storage-item .progress {
            height: 8px;
            background: #ddd;
            border-radius: 4px;
            margin-top: 10px;
            overflow: hidden;
        }
        
        .storage-item .progress-bar {
            height: 100%;
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            border-radius: 4px;
        }
        
        .btn-danger {
            background: #f44336;
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: var(--border-radius);
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .compact-mode .item-image img {
            max-height: 120px;
        }
        
        .compact-mode .item-description {
            max-height: 60px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-graduation-cap"></i>
                    <div class="logo-text">
                        <h1>ููู ุฅูุฌุงุฒ ุงููุนููุฉ</h1>
                        <h2>ูุฑูุงู  ุงูุบูุงุฑู</h2>
                    </div>
                </div>
                <div class="header-actions">
                    <button class="btn btn-primary" onclick="showSubjectSelection()">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุฌุฏูุฏ
                    </button>
                    <button class="btn btn-secondary" onclick="clearLocalStorage()" title="ุชูุธูู ุงูุชุฎุฒูู ุงููุญูู">
                        <i class="fas fa-broom"></i> ุชูุธูู
                    </button>
                    <button class="btn btn-secondary" onclick="printPortfolio()">
                        <i class="fas fa-print"></i> ุทุจุงุนุฉ
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="navigation">
        <div class="container">
            <div class="nav-tabs">
                <button class="nav-tab active" data-tab="all">
                    <i class="fas fa-home"></i> ุงูุฑุฆูุณูุฉ
                </button>
                <button class="nav-tab" data-tab="arabic">
                    <i class="fas fa-book"></i> ุงูุนุฑุจูุฉ
                </button>
                <button class="nav-tab" data-tab="english">
                    <i class="fas fa-language"></i> ุงูุฅูุฌููุฒูุฉ
                </button>
                <button class="nav-tab" data-tab="quran">
                    <i class="fas fa-book-quran"></i> ุงููุฑุขู
                </button>
                <button class="nav-tab" data-tab="math">
                    <i class="fas fa-calculator"></i> ุงูุฑูุงุถูุงุช
                </button>
                <button class="nav-tab" data-tab="science">
                    <i class="fas fa-flask"></i> ุงูุนููู
                </button>
                <button class="nav-tab" data-tab="activities">
                    <i class="fas fa-chalkboard-teacher"></i> ุงููุดุงุทุงุช
                </button>
                <button class="nav-tab" data-tab="manage" onclick="switchTab('manage')">
                    <i class="fas fa-cog"></i> ุงูุฅุฏุงุฑุฉ
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main">
        <div class="container">
            <!-- Dashboard -->
            <section id="all" class="tab-content active">
                <div class="section-header">
                    <h2><i class="fas fa-chart-line"></i> ูุธุฑุฉ ุนุงูุฉ</h2>
                    <p>ุฅุญุตุงุฆูุงุช ูุฅูุฌุงุฒุงุช ููู ุงูุฅูุฌุงุฒ</p>
                </div>
                
                <!-- Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
                            <i class="fas fa-book-open"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalItems">0</h3>
                            <p>ุฅุฌูุงูู ุงูุนูุงุตุฑ</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                            <i class="fas fa-images"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="totalImages">0</h3>
                            <p>ุนุฏุฏ ุงูุตูุฑ</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                            <i class="fas fa-calendar-alt"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="recentItems">0</h3>
                            <p>ูุฐุง ุงูุดูุฑ</p>
                        </div>
                    </div>
                    
                    <div class="stat-card">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
                            <i class="fas fa-star"></i>
                        </div>
                        <div class="stat-info">
                            <h3 id="completionRate">0%</h3>
                            <p>ูุนุฏู ุงูุฅูุฌุงุฒ</p>
                        </div>
                    </div>
                </div>
                
                <!-- Recent Items -->
                <div class="recent-items">
                    <h3><i class="fas fa-history"></i> ุฃุญุฏุซ ุงูุฅุถุงูุงุช</h3>
                    <div class="items-grid" id="recentItemsGrid">
                        <!-- ุณูุชู ุชุนุจุฆุชูุง ุจุงูุจูุงูุงุช -->
                    </div>
                </div>
            </section>

            <!-- Arabic Section -->
            <section id="arabic" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-book"></i>
                        </div>
                        <div>
                            <h2>ุงููุบุฉ ุงูุนุฑุจูุฉ</h2>
                            <p>ุญุฑูู ูุฃูุดุทุฉ ุงููุบุฉ ุงูุนุฑุจูุฉ</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addItem('arabic')">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุญุฑู
                    </button>
                </div>
                
                <!-- Arabic Items Grid -->
                <div class="items-grid" id="arabicItems">
                    <div class="empty-state">
                        <i class="fas fa-book-open"></i>
                        <h3>ูุง ุชูุฌุฏ ุญุฑูู ูุถุงูุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ุญุฑู ุนุฑุจู</p>
                        <button class="btn btn-primary" onclick="addItem('arabic')">
                            <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุญุฑู ุฌุฏูุฏ
                        </button>
                    </div>
                </div>
            </section>

            <!-- English Section -->
            <section id="english" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-language"></i>
                        </div>
                        <div>
                            <h2>ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</h2>
                            <p>ูููุงุช ูุฃูุดุทุฉ ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addItem('english')">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ูููุฉ
                    </button>
                </div>
                
                <div class="items-grid" id="englishItems">
                    <div class="empty-state">
                        <i class="fas fa-language"></i>
                        <h3>ูุง ุชูุฌุฏ ูููุงุช ูุถุงูุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ูููุฉ ุฅูุฌููุฒูุฉ</p>
                    </div>
                </div>
            </section>

            <!-- Quran Section -->
            <section id="quran" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-book-quran"></i>
                        </div>
                        <div>
                            <h2>ุงููุฑุขู ุงููุฑูู</h2>
                            <p>ุณูุฑ ูุฃูุดุทุฉ ุงููุฑุขู ุงููุฑูู</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addItem('quran')">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุณูุฑุฉ
                    </button>
                </div>
                
                <div class="items-grid" id="quranItems">
                    <div class="empty-state">
                        <i class="fas fa-book-quran"></i>
                        <h3>ูุง ุชูุฌุฏ ุณูุฑ ูุถุงูุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ุณูุฑุฉ ูุฑุขููุฉ</p>
                    </div>
                </div>
            </section>

            <!-- Math Section -->
            <section id="math" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-calculator"></i>
                        </div>
                        <div>
                            <h2>ุงูุฑูุงุถูุงุช</h2>
                            <p>ููุงููู ูุฃูุดุทุฉ ุงูุฑูุงุถูุงุช</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addItem('math')">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ููููู
                    </button>
                </div>
                
                <div class="items-grid" id="mathItems">
                    <div class="empty-state">
                        <i class="fas fa-calculator"></i>
                        <h3>ูุง ุชูุฌุฏ ููุงููู ูุถุงูุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ููููู ุฑูุงุถู</p>
                    </div>
                </div>
            </section>

            <!-- Science Section -->
            <section id="science" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div>
                            <h2>ุงูุนููู</h2>
                            <p>ุชุฌุงุฑุจ ูุฃูุดุทุฉ ุงูุนููู</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addItem('science')">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุชุฌุฑุจุฉ
                    </button>
                </div>
                
                <div class="items-grid" id="scienceItems">
                    <div class="empty-state">
                        <i class="fas fa-flask"></i>
                        <h3>ูุง ุชูุฌุฏ ุชุฌุงุฑุจ ูุถุงูุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ุชุฌุฑุจุฉ ุนูููุฉ</p>
                    </div>
                </div>
            </section>

            <!-- Activities Section -->
            <section id="activities" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div>
                            <h2>ุงููุดุงุทุงุช ุงููุฏุฑุณูุฉ</h2>
                            <p>ุฅูุฌุงุฒุงุช ูุฃูุดุทุฉ ุงููุนููุฉ</p>
                        </div>
                    </div>
                    <button class="btn btn-primary" onclick="addItem('activities')">
                        <i class="fas fa-plus"></i> ุฅุถุงูุฉ ูุดุงุท
                    </button>
                </div>
                
                <div class="items-grid" id="activitiesItems">
                    <div class="empty-state">
                        <i class="fas fa-chalkboard-teacher"></i>
                        <h3>ูุง ุชูุฌุฏ ูุดุงุทุงุช ูุถุงูุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุฃูู ูุดุงุท ูุฏุฑุณู</p>
                    </div>
                </div>
            </section>

            <!-- Management Section -->
            <section id="manage" class="tab-content">
                <div class="section-header">
                    <div class="section-title">
                        <div class="section-icon" style="background: linear-gradient(135deg, #666 0%, #333 100%);">
                            <i class="fas fa-cog"></i>
                        </div>
                        <div>
                            <h2>ุฅุฏุงุฑุฉ ุงููุธุงู</h2>
                            <p>ุฃุฏูุงุช ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ูุงูุฅุนุฏุงุฏุงุช</p>
                        </div>
                    </div>
                </div>

                <!-- Data Management -->
                <div class="data-management">
                    <h3><i class="fas fa-database"></i> ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช</h3>
                    
                    <div class="storage-info">
                        <div class="storage-item">
                            <h4>ุงูุชุฎุฒูู ุงููุญูู</h4>
                            <p id="localStorageUsage">0% ูุณุชุฎุฏู</p>
                            <div class="progress">
                                <div class="progress-bar" id="localStorageBar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="storage-item">
                            <h4>ุนูุงุตุฑ ูุญููุธุฉ</h4>
                            <p id="savedItemsCount">0 ุนูุตุฑ</p>
                            <div class="progress">
                                <div class="progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                        
                        <div class="storage-item">
                            <h4>ุญุฌู ุงูุจูุงูุงุช</h4>
                            <p id="dataSize">0 KB</p>
                            <div class="progress">
                                <div class="progress-bar" style="width: 0%"></div>
                            </div>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-top: 20px; flex-wrap: wrap;">
                        <button class="btn btn-secondary" onclick="exportData()">
                            <i class="fas fa-download"></i> ุชุตุฏูุฑ ุงูุจูุงูุงุช
                        </button>
                        
                        <label class="btn btn-secondary" style="cursor: pointer;">
                            <i class="fas fa-upload"></i> ุงุณุชูุฑุงุฏ ุจูุงูุงุช
                            <input type="file" accept=".json" onchange="importData(event)" style="display: none;">
                        </label>
                        
                        <button class="btn-danger" onclick="clearAllData()">
                            <i class="fas fa-trash-alt"></i> ุญุฐู ุฌููุน ุงูุจูุงูุงุช
                        </button>
                        
                        <button class="btn btn-secondary" onclick="toggleCompactMode()">
                            <i class="fas fa-compress-alt"></i> ูุถุน ูุฏูุฌ
                        </button>
                    </div>
                    
                    <div style="margin-top: 25px; padding-top: 20px; border-top: 1px solid var(--light-gray);">
                        <h4><i class="fas fa-info-circle"></i> ูุนูููุงุช ุงููุธุงู</h4>
                        <div style="background: var(--light-gray); padding: 15px; border-radius: 10px; margin-top: 10px;">
                            <p><strong>ุงูุญุงูุฉ:</strong> <span id="systemStatus">โ ุงููุธุงู ูุนูู ุจุดูู ุทุจูุนู</span></p>
                            <p><strong>ุงููุณุฎุฉ:</strong> 2.0.0</p>
                            <p><strong>ุขุฎุฑ ุชุญุฏูุซ:</strong> <span id="lastUpdate">ูู ูุชู ุงูุชุญุฏูุซ ุจุนุฏ</span></p>
                            <p><strong>ุงูุชุฎุฒูู ุงููุณุชุฎุฏู:</strong> <span id="storageDetails">ุฌุงุฑู ุงูุชุญููู...</span></p>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-info">
                    <h3><i class="fas fa-graduation-cap"></i> ููู ุงูุฅูุฌุงุฒ ุงูุฑููู</h3>
                    <p>ุงููุนููุฉ ูุฑูุงู ุนุจุฏุงููู ุงูุบูุงุฑู - ุงุจุชุฏุงุฆูุฉ ุงููุฎุจุฉ</p>
                </div>
                <div class="footer-stats">
                    <p>ุงูุนุงู ุงูุฏุฑุงุณู: ูกูคูคูฅ - ูกูคูคูฆ ูู</p>
                    <p id="connectionStatus">ูุธุงู ุชุฎุฒูู ูุญูู + Firebase</p>
                </div>
            </div>
        </div>
    </footer>

    <!-- Add Item Modal -->
    <div class="modal" id="addModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modalTitle">ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ</h3>
                <button class="close" onclick="closeModal()">&times;</button>
            </div>
            <div class="modal-body">
                <form id="itemForm">
                    <input type="hidden" id="itemSubject">
                    
                    <div class="form-group">
                        <label for="itemName">ุงูุนููุงู</label>
                        <input type="text" id="itemName" placeholder="ูุซุงู: ุญุฑู ุงูุฃููุ ุงูุณูุฑุฉ ุงูููุงููุฉ..." required>
                    </div>
                    
                    <div class="form-group">
                        <label for="itemDesc">ุงููุตู</label>
                        <textarea id="itemDesc" placeholder="ูุตู ุงููุดุงุท..." rows="4"></textarea>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label>ุงูุตูุฑุฉ ุงูุฃููู (ุงุฎุชูุงุฑู)</label>
                            <div class="file-upload">
                                <input type="file" id="image1" accept="image/*" class="file-input">
                                <label for="image1" class="file-label">
                                    <i class="fas fa-upload"></i>
                                    <span>ุงุฎุชุฑ ุตูุฑุฉ</span>
                                </label>
                            </div>
                            <div class="image-preview" id="preview1"></div>
                        </div>
                        
                        <div class="form-group">
                            <label>ุงูุตูุฑุฉ ุงูุซุงููุฉ (ุงุฎุชูุงุฑู)</label>
                            <div class="file-upload">
                                <input type="file" id="image2" accept="image/*" class="file-input">
                                <label for="image2" class="file-label">
                                    <i class="fas fa-upload"></i>
                                    <span>ุงุฎุชุฑ ุตูุฑุฉ</span>
                                </label>
                            </div>
                            <div class="image-preview" id="preview2"></div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="btn btn-secondary" onclick="closeModal()">ุฅูุบุงุก</button>
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i> ุญูุธ
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Image Viewer Modal -->
    <div class="modal" id="imageModal">
        <div class="modal-content modal-lg">
            <div class="modal-header">
                <h3>ูุนุงููุฉ ุงูุตูุฑุฉ</h3>
                <button class="close" onclick="closeImageModal()">&times;</button>
            </div>
            <div class="modal-body">
                <img id="modalImageView" class="modal-image">
            </div>
        </div>
    </div>

    <!-- Firebase Configuration -->
    <script>
        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyDLJPdy0F4W6iqkUCnKw1jc2CCeGNe5cBU",
            authDomain: "teacher-portfolio-fryal.firebaseapp.com",
            projectId: "teacher-portfolio-fryal",
            storageBucket: "teacher-portfolio-fryal.firebasestorage.app",
            messagingSenderId: "1054582250352",
            appId: "1:1054582250352:web:0fbb6f5a8c2763ffcc4db5",
            measurementId: "G-74HC2DH4YP"
        };

        // Initialize Firebase
        try {
            const app = firebase.initializeApp(firebaseConfig);
            const db = firebase.firestore();
            
            window.firebaseApp = app;
            window.firebaseDb = db;
            
            console.log("โ Firebase initialized successfully");
            
            // Test connection
            db.collection('test').doc('test').get()
                .then(() => console.log("โ Firestore connection test passed"))
                .catch(err => console.log("โ๏ธ Firestore test:", err.message));
            
        } catch (error) {
            console.log("โ๏ธ Firebase initialization error:", error.message);
            // Create mock object to avoid errors
            window.firebaseDb = {
                collection: () => ({
                    doc: () => ({
                        get: () => Promise.resolve({ exists: false }),
                        set: () => Promise.resolve(),
                        delete: () => Promise.resolve()
                    }),
                    where: () => ({ get: () => Promise.resolve({ empty: true }) }),
                    orderBy: () => ({ get: () => Promise.resolve({ empty: true }) }),
                    limit: () => ({ get: () => Promise.resolve({ empty: true }) })
                })
            };
        }
    </script>

    <!-- Main Script -->
    <script>
        // ูุธุงู ููู ุงูุฅูุฌุงุฒ - ุงููุนููุฉ ูุฑูุงู ุงูุบูุงุฑู
        console.log('๐ ูุธุงู ููู ุงูุฅูุฌุงุฒ - ุฌุงุฑู ุงูุชุญููู...');

        // ุงูุจูุงูุงุช ุงูุนุงูููุฉ
        let portfolioData = {
            arabic: [],
            english: [],
            quran: [],
            math: [],
            science: [],
            activities: []
        };

        let currentSubject = null;
        let isFirebaseConnected = false;
        let compactMode = false;

        // ุชููุฆุฉ ุงูุชุทุจูู
        document.addEventListener('DOMContentLoaded', function() {
            console.log('๐ ุจุฏุก ุชููุฆุฉ ุงูุชุทุจูู...');
            
            try {
                // 1. ุฅุนุฏุงุฏ ุงูุฃุญุฏุงุซ
                setupEventListeners();
                
                // 2. ุชุญููู ุงูุจูุงูุงุช
                loadData();
                
                // 3. ุนุฑุถ ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ
                updateDashboard();
                
                // 4. ุชุญุฏูุซ ูุนูููุงุช ุงูุชุฎุฒูู
                updateStorageInfo();
                
                console.log('โ ุชู ุชููุฆุฉ ุงูุชุทุจูู ุจูุฌุงุญ');
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุชููุฆุฉ ุงูุชุทุจูู:', error);
                showToast('ุญุฏุซ ุฎุทุฃ ูู ุชุญููู ุงูุชุทุจูู', 'error');
            }
        });

        // ุฅุนุฏุงุฏ ูุณุชูุนู ุงูุฃุญุฏุงุซ
        function setupEventListeners() {
            console.log('๐ง ุฌุงุฑู ุฅุนุฏุงุฏ ูุงุฌูุฉ ุงููุณุชุฎุฏู...');
            
            // ุงูุชุจููุจุงุช
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.addEventListener('click', function() {
                    const tabId = this.getAttribute('data-tab');
                    switchTab(tabId);
                });
            });
            
            // ูููุฐุฌ ุงูุฅุถุงูุฉ
            document.getElementById('itemForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveItem();
            });
            
            // ูุนุงููุฉ ุงูุตูุฑ
            document.getElementById('image1').addEventListener('change', function(e) {
                previewImage(e.target, 'preview1');
            });
            
            document.getElementById('image2').addEventListener('change', function(e) {
                previewImage(e.target, 'preview2');
            });
            
            console.log('โ ุชู ุฅุนุฏุงุฏ ูุงุฌูุฉ ุงููุณุชุฎุฏู');
        }

        // ==============================================
        // ๐ ุงููุธุงู ุงูุฑุฆูุณู
        // ==============================================

        // ุชุญููู ุงูุจูุงูุงุช
        async function loadData() {
            console.log('๐ฅ ุฌุงุฑู ุชุญููู ุงูุจูุงูุงุช...');
            
            try {
                // 1. ุชุญููู ูู ุงูุชุฎุฒูู ุงููุญูู ุฃููุงู (ุณุฑุนุฉ)
                const savedData = localStorage.getItem('teacherPortfolio_v2');
                if (savedData) {
                    portfolioData = JSON.parse(savedData);
                    console.log('โ ุชู ุชุญููู ุงูุจูุงูุงุช ูู ุงูุชุฎุฒูู ุงููุญูู');
                    showToast('ุชู ุชุญููู ุงูุจูุงูุงุช ุงููุญููุธุฉ', 'success');
                } else {
                    loadSampleData();
                }
                
                // 2. ูุญุงููุฉ Firebase (ุจุดูู ุบูุฑ ูุชุฒุงูู)
                try {
                    if (window.firebaseDb) {
                        await loadFromFirebase();
                    }
                } catch (firebaseError) {
                    console.warn('โ๏ธ ูุดู ุงูุงุชุตุงู ุจู Firebase:', firebaseError.message);
                }
                
                updateDashboard();
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุชุญููู ุงูุจูุงูุงุช:', error);
                loadSampleData();
            }
        }

        // ุชุญููู ูู Firebase
        async function loadFromFirebase() {
            try {
                console.log('๐ ูุญุงููุฉ ุชุญููู ุงูุจูุงูุงุช ูู Firebase...');
                
                // ุชุญููู ุงูุจูุงูุงุช ูู Firestore
                const querySnapshot = await window.firebaseDb
                    .collection('portfolio_items')
                    .get();
                
                if (!querySnapshot.empty) {
                    // ุฅุนุงุฏุฉ ุชุนููู ุงูุจูุงูุงุช
                    portfolioData = {
                        arabic: [],
                        english: [],
                        quran: [],
                        math: [],
                        science: [],
                        activities: []
                    };
                    
                    // ุชุตููู ุงูุนูุงุตุฑ ุญุณุจ ุงููุณู
                    querySnapshot.forEach(doc => {
                        const item = doc.data();
                        const subject = item.subject || 'activities';
                        
                        if (portfolioData[subject]) {
                            portfolioData[subject].push(item);
                        }
                    });
                    
                    console.log(`โ ุชู ุชุญููู ${querySnapshot.size} ุนูุตุฑ ูู Firebase`);
                    isFirebaseConnected = true;
                    
                    // ุญูุธ ูุณุฎุฉ ูุญููุฉ
                    localStorage.setItem('teacherPortfolio_v2', JSON.stringify(portfolioData));
                    
                } else {
                    console.log('๐ญ ูุง ุชูุฌุฏ ุจูุงูุงุช ูู Firebase');
                    isFirebaseConnected = true;
                }
                
            } catch (error) {
                console.warn('โ๏ธ ูุดู ุชุญููู Firebase:', error.message);
                isFirebaseConnected = false;
            }
        }

        // ุชุญููู ุจูุงูุงุช ูููุฐุฌูุฉ
        function loadSampleData() {
            console.log('๐ ุฌุงุฑู ุชุญููู ุจูุงูุงุช ูููุฐุฌูุฉ...');
            
            portfolioData = {
                arabic: [
                    {
                        id: '1',
                        subject: 'arabic',
                        title: 'ุญุฑู ุงูุฃูู',
                        description: 'ุชุนูู ุญุฑู ุงูุฃูู ูุน ูุดุงุท ุงูุฑุณู ูุงูุชูููู',
                        imageUrls: [
                            'https://images.unsplash.com/photo-1580582932707-520aed937b7b?auto=format&fit=crop&w=400&q=80',
                            'https://images.unsplash.com/photo-1481627834876-b7833e8f5570?auto=format&fit=crop&w=400&q=80'
                        ],
                        date: 'ูกูคูคูฅ/ููฃ/ูกูฅ',
                        timestamp: Date.now()
                    }
                ],
                english: [
                    {
                        id: '2',
                        subject: 'english',
                        title: 'ุญุฑู A',
                        description: 'Learning letter A with fun activities',
                        imageUrls: [
                            'https://images.unsplash.com/photo-1523580494863-6f3031224c94?auto=format&fit=crop&w=400&q=80',
                            'https://images.unsplash.com/photo-1503676260728-1c00da094a0b?auto=format&fit=crop&w=400&q=80'
                        ],
                        date: 'ูกูคูคูฅ/ููฃ/ูกูค',
                        timestamp: Date.now() - 86400000
                    }
                ],
                quran: [],
                math: [],
                science: [],
                activities: []
            };
            
            localStorage.setItem('teacherPortfolio_v2', JSON.stringify(portfolioData));
            showToast('ุชู ุชุญููู ุจูุงูุงุช ูููุฐุฌูุฉ', 'info');
        }

        // ุญูุธ ุงูุนูุตุฑ
        async function saveItem() {
            console.log('๐พ ุฌุงุฑู ุญูุธ ุงูุนูุตุฑ...');
            
            const subject = document.getElementById('itemSubject').value;
            const name = document.getElementById('itemName').value.trim();
            const description = document.getElementById('itemDesc').value.trim();
            
            if (!name) {
                showToast('ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงูุนููุงู', 'error');
                return;
            }
            
            try {
                showToast('ุฌุงุฑู ุญูุธ ุงูุนูุตุฑ...', 'info');
                
                // ุฅูุดุงุก ุงูุนูุตุฑ
                const itemId = `item_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;
                const item = {
                    id: itemId,
                    subject: subject,
                    title: name,
                    description: description,
                    date: new Date().toLocaleDateString('ar-SA'),
                    timestamp: Date.now(),
                    imageUrls: [],
                    lastUpdated: Date.now()
                };
                
                // ุฅุถุงูุฉ ุญููู ุฎุงุตุฉ
                switch(subject) {
                    case 'arabic':
                        item.letter = name;
                        break;
                    case 'english':
                        item.letter = name;
                        break;
                    case 'quran':
                        item.surah = name;
                        break;
                    case 'math':
                    case 'science':
                        item.concept = name;
                        break;
                }
                
                // ูุนุงูุฌุฉ ุงูุตูุฑ (ุถุบุท ูุชุญููู)
                const image1 = document.getElementById('image1').files[0];
                const image2 = document.getElementById('image2').files[0];
                
                if (image1) {
                    const url1 = await processAndCompressImage(image1);
                    if (url1) item.imageUrls.push(url1);
                }
                
                if (image2) {
                    const url2 = await processAndCompressImage(image2);
                    if (url2) item.imageUrls.push(url2);
                }
                
                // ุฅุถุงูุฉ ุฅูู ุงูุจูุงูุงุช ุงููุญููุฉ
                portfolioData[subject].unshift(item);
                
                // ุญูุธ ูู ุงูุชุฎุฒูู ุงููุญูู
                saveToLocalStorage();
                console.log('โ ุชู ุงูุญูุธ ูู ุงูุชุฎุฒูู ุงููุญูู');
                
                // ูุญุงููุฉ ุงูุญูุธ ูู Firebase
                try {
                    if (window.firebaseDb) {
                        await window.firebaseDb.collection('portfolio_items').doc(itemId).set({
                            ...item,
                            lastUpdated: firebase.firestore.FieldValue.serverTimestamp()
                        });
                        console.log('โ ุชู ุงูุญูุธ ูู Firebase');
                    }
                } catch (firebaseError) {
                    console.warn('โ๏ธ ูุดู ุงูุญูุธ ูู Firebase:', firebaseError.message);
                    // ูุง ูุดููุฉุ ุงูุจูุงูุงุช ูุญููุธุฉ ูุญููุงู
                }
                
                // ุชุญุฏูุซ ุงููุงุฌูุฉ
                updateDashboard();
                updateSection(subject);
                
                // ุชุญุฏูุซ ูุนูููุงุช ุงูุชุฎุฒูู
                updateStorageInfo();
                
                // ุฅุบูุงู ุงููููุฐุฌ
                closeModal();
                
                showToast('ุชู ุฅุถุงูุฉ ุงูุนูุตุฑ ุจูุฌุงุญ', 'success');
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุญูุธ ุงูุนูุตุฑ:', error);
                
                if (error.name === 'QuotaExceededError') {
                    showToast('ุงูุชุฎุฒูู ููุชูุฆุ ูุฑุฌู ุญุฐู ุจุนุถ ุงูุนูุงุตุฑ ุงููุฏููุฉ', 'error');
                } else {
                    showToast('ุญุฏุซ ุฎุทุฃ ูู ุญูุธ ุงูุนูุตุฑ', 'error');
                }
            }
        }

        // ูุนุงูุฌุฉ ูุถุบุท ุงูุตูุฑุฉ
        async function processAndCompressImage(imageFile, maxWidth = 800, quality = 0.7) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = new Image();
                    img.onload = function() {
                        const canvas = document.createElement('canvas');
                        const ctx = canvas.getContext('2d');
                        
                        // ุญุณุงุจ ุงูุฃุจุนุงุฏ ุงูุฌุฏูุฏุฉ
                        let width = img.width;
                        let height = img.height;
                        
                        if (width > maxWidth) {
                            height = (height * maxWidth) / width;
                            width = maxWidth;
                        }
                        
                        canvas.width = width;
                        canvas.height = height;
                        
                        // ุฑุณู ุงูุตูุฑุฉ ุงููุถุบูุทุฉ
                        ctx.drawImage(img, 0, 0, width, height);
                        
                        // ุชุญููู ุฅูู Base64
                        const compressedBase64 = canvas.toDataURL('image/jpeg', quality);
                        resolve(compressedBase64);
                    };
                    img.src = e.target.result;
                };
                reader.readAsDataURL(imageFile);
            });
        }

        // ุญูุธ ูู ุงูุชุฎุฒูู ุงููุญูู ูุน ุงูุชุญูู ุจุงูุญุฌู
        function saveToLocalStorage() {
            try {
                // ุงูุชุญูู ูู ุญุฌู ุงูุจูุงูุงุช ูุจู ุงูุญูุธ
                const dataStr = JSON.stringify(portfolioData);
                const dataSize = new Blob([dataStr]).size;
                const maxSize = 4 * 1024 * 1024; // 4MB ุญุฏ ุฃูุตู
                
                if (dataSize > maxSize) {
                    // ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ูุจูุฑุฉ ุฌุฏุงูุ ุงุญุฐู ุงูุนูุงุตุฑ ุงููุฏููุฉ
                    cleanupOldItems();
                    
                    // ุญุงูู ูุฑุฉ ุฃุฎุฑู
                    const newDataStr = JSON.stringify(portfolioData);
                    const newDataSize = new Blob([newDataStr]).size;
                    
                    if (newDataSize > maxSize) {
                        throw new Error('QuotaExceededError');
                    }
                    
                    localStorage.setItem('teacherPortfolio_v2', newDataStr);
                } else {
                    localStorage.setItem('teacherPortfolio_v2', dataStr);
                }
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุญูุธ ุงูุชุฎุฒูู ุงููุญูู:', error);
                throw error;
            }
        }

        // ุชูุธูู ุงูุนูุงุตุฑ ุงููุฏููุฉ
        function cleanupOldItems() {
            console.log('๐งน ุฌุงุฑู ุชูุธูู ุงูุนูุงุตุฑ ุงููุฏููุฉ...');
            
            Object.keys(portfolioData).forEach(subject => {
                // ุงุญุชูุธ ุจู 50 ุนูุตุฑ ููุท ููู ูุณู
                if (portfolioData[subject].length > 50) {
                    portfolioData[subject] = portfolioData[subject]
                        .sort((a, b) => b.timestamp - a.timestamp)
                        .slice(0, 50);
                }
            });
            
            showToast('ุชู ุชูุธูู ุงูุนูุงุตุฑ ุงููุฏููุฉ ุชููุงุฆูุงู', 'info');
        }

        // ==============================================
        // ๐ง ุฃุฏูุงุช ุงูุฅุฏุงุฑุฉ
        // ==============================================

        // ุชุญุฏูุซ ูุนูููุงุช ุงูุชุฎุฒูู
        function updateStorageInfo() {
            try {
                // ุญุณุงุจ ุญุฌู ุงูุจูุงูุงุช
                const dataStr = JSON.stringify(portfolioData);
                const dataSize = new Blob([dataStr]).size;
                const dataSizeKB = Math.round(dataSize / 1024);
                
                // ุญุณุงุจ ุฅุฌูุงูู ุงูุนูุงุตุฑ
                const totalItems = Object.values(portfolioData).reduce((sum, arr) => sum + arr.length, 0);
                
                // ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู
                document.getElementById('savedItemsCount').textContent = `${totalItems} ุนูุตุฑ`;
                document.getElementById('dataSize').textContent = `${dataSizeKB} KB`;
                
                // ุญุณุงุจ ูุณุจุฉ ุงุณุชุฎุฏุงู ุงูุชุฎุฒูู ุงููุญูู
                let totalSpace = 5 * 1024 * 1024; // 5MB ุชูุฑูุจุงู
                try {
                    // ูุญุงููุฉ ุชูุฏูุฑ ุงููุณุงุญุฉ ุงููุชุงุญุฉ
                    let testData = '';
                    for (let i = 0; i < 10000; i++) {
                        testData += 'xxxxxxxxxx';
                    }
                    localStorage.setItem('test', testData);
                    localStorage.removeItem('test');
                } catch (e) {
                    // ุชุฌุงูู ุงูุฎุทุฃ
                }
                
                const usagePercent = Math.min(100, Math.round((dataSize / totalSpace) * 100));
                document.getElementById('localStorageUsage').textContent = `${usagePercent}% ูุณุชุฎุฏู`;
                document.getElementById('localStorageBar').style.width = `${usagePercent}%`;
                
                // ุชุญุฏูุซ ุญุงูุฉ ุงููุธุงู
                if (usagePercent > 90) {
                    document.getElementById('systemStatus').innerHTML = 'โ๏ธ <span style="color: #f44336;">ุงูุชุฎุฒูู ุดุจู ููุชูุฆ</span>';
                } else if (usagePercent > 70) {
                    document.getElementById('systemStatus').innerHTML = 'โ๏ธ <span style="color: #ff9800;">ุงูุชุฎุฒูู ููุชูุฆ ุฌุฒุฆูุงู</span>';
                } else {
                    document.getElementById('systemStatus').innerHTML = 'โ <span style="color: #4CAF50;">ุงููุธุงู ูุนูู ุจุดูู ุทุจูุนู</span>';
                }
                
                document.getElementById('storageDetails').textContent = `${dataSizeKB} KB ูู ${Math.round(totalSpace/1024)} KB`;
                document.getElementById('lastUpdate').textContent = new Date().toLocaleString('ar-SA');
                
            } catch (error) {
                console.warn('โ๏ธ ุฎุทุฃ ูู ุชุญุฏูุซ ูุนูููุงุช ุงูุชุฎุฒูู:', error);
            }
        }

        // ุชูุธูู ุงูุชุฎุฒูู ุงููุญูู
        function clearLocalStorage() {
            if (confirm('ูู ุชุฑูุฏ ุชูุธูู ุงูุชุฎุฒูู ุงููุญููุ ุณูุชู ุญุฐู ุงูุจูุงูุงุช ุงููุคูุชุฉ ููุท.')) {
                // ุญุฐู ุงูุนูุงุตุฑ ุงููุฏููุฉ ููุท
                cleanupOldItems();
                saveToLocalStorage();
                updateDashboard();
                updateStorageInfo();
                showToast('ุชู ุชูุธูู ุงูุชุฎุฒูู ุงููุญูู', 'success');
            }
        }

        // ุญุฐู ุฌููุน ุงูุจูุงูุงุช
        function clearAllData() {
            if (confirm('โ๏ธ ุชุญุฐูุฑ: ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ุฌููุน ุงูุจูุงูุงุชุ\n\nูุฐุง ุงูุฅุฌุฑุงุก ูุง ูููู ุงูุชุฑุงุฌุน ุนูู ูุณูุชู ุญุฐู:\nโข ุฌููุน ุงูุนูุงุตุฑ\nโข ุฌููุน ุงูุตูุฑ\nโข ุฌููุน ุงูุจูุงูุงุช ุงููุญููุธุฉ')) {
                portfolioData = {
                    arabic: [],
                    english: [],
                    quran: [],
                    math: [],
                    science: [],
                    activities: []
                };
                
                localStorage.removeItem('teacherPortfolio_v2');
                
                // ูุญุงููุฉ ุญุฐู ูู Firebase
                if (window.firebaseDb) {
                    // ูููู ุฅุถุงูุฉ ููุฏ ูุญุฐู ุงูุจูุงูุงุช ูู Firebase ููุง
                }
                
                updateDashboard();
                updateStorageInfo();
                
                showToast('ุชู ุญุฐู ุฌููุน ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
            }
        }

        // ุชุตุฏูุฑ ุงูุจูุงูุงุช
        function exportData() {
            const dataStr = JSON.stringify(portfolioData, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const dataUrl = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = dataUrl;
            link.download = `ููู-ุงูุฅูุฌุงุฒ-${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            
            showToast('ุชู ุชุตุฏูุฑ ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
        }

        // ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช
        function importData(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // ุงูุชุญูู ูู ุตุญุฉ ุงูุจูุงูุงุช
                    if (importedData.arabic !== undefined) {
                        portfolioData = importedData;
                        saveToLocalStorage();
                        updateDashboard();
                        updateStorageInfo();
                        showToast('ุชู ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช ุจูุฌุงุญ', 'success');
                    } else {
                        showToast('ููู ุบูุฑ ุตุงูุญ. ุชุฃูุฏ ูู ุตูุบุฉ ุงูููู.', 'error');
                    }
                } catch (error) {
                    console.error('โ ุฎุทุฃ ูู ุงุณุชูุฑุงุฏ ุงูุจูุงูุงุช:', error);
                    showToast('ููู ุบูุฑ ุตุงูุญ ุฃู ุชุงูู', 'error');
                }
            };
            reader.readAsText(file);
            
            // ูุณุญ ูููุฉ ุงููุฏุฎู
            event.target.value = '';
        }

        // ุชุจุฏูู ูุถุน ุงููุฏูุฌ
        function toggleCompactMode() {
            compactMode = !compactMode;
            const body = document.body;
            
            if (compactMode) {
                body.classList.add('compact-mode');
                showToast('ุชู ุชูุนูู ุงููุถุน ุงููุฏูุฌ', 'info');
            } else {
                body.classList.remove('compact-mode');
                showToast('ุชู ุชุนุทูู ุงููุถุน ุงููุฏูุฌ', 'info');
            }
            
            updateDashboard();
        }

        // ==============================================
        // ๐ ุจุงูู ุงูุฏูุงู
        // ==============================================

        // ุจุงูู ุงูุฏูุงู (ููุณ ุงููุณุฎุฉ ุงูุณุงุจูุฉ)...
        // updateDashboard, updateConnectionStatus, updateRecentItems, switchTab,
        // updateSection, createItemCard, getDefaultImage, getSubjectIcon,
        // addItem, previewImage, editItem, deleteItem, closeModal, viewImage,
        // closeImageModal, printPortfolio, formatDate, showToast, showSubjectSelection

        // ุชุญุฏูุซ ููุญุฉ ุงูุชุญูู
        function updateDashboard() {
            console.log('๐ ุชุญุฏูุซ ููุญุฉ ุงูุชุญูู...');
            
            // ุญุณุงุจ ุงูุฅุญุตุงุฆูุงุช
            const totalItems = Object.values(portfolioData).reduce((sum, arr) => sum + arr.length, 0);
            const totalImages = Object.values(portfolioData).reduce((sum, arr) => 
                sum + arr.reduce((imgSum, item) => imgSum + (item.imageUrls ? item.imageUrls.length : 0), 0), 0);
            
            const thisMonth = new Date().getMonth();
            const thisYear = new Date().getFullYear();
            const recentItems = Object.values(portfolioData).reduce((sum, arr) => 
                sum + arr.filter(item => {
                    const itemDate = new Date(item.timestamp || Date.now());
                    return itemDate.getMonth() === thisMonth && itemDate.getFullYear() === thisYear;
                }).length, 0);
            
            // ุชุญุฏูุซ DOM
            document.getElementById('totalItems').textContent = totalItems;
            document.getElementById('totalImages').textContent = totalImages;
            document.getElementById('recentItems').textContent = recentItems;
            
            const completionRate = totalItems > 0 ? Math.min(100, Math.floor((totalItems / 100) * 100)) : 0;
            document.getElementById('completionRate').textContent = `${completionRate}%`;
            
            // ุชุญุฏูุซ ุญุงูุฉ ุงูุงุชุตุงู
            updateConnectionStatus();
            
            // ุชุญุฏูุซ ุงูุนูุงุตุฑ ุงูุญุฏูุซุฉ
            updateRecentItems();
            
            // ุชุญุฏูุซ ูู ูุณู
            Object.keys(portfolioData).forEach(subject => {
                updateSection(subject);
            });
        }

        // ุชุญุฏูุซ ุญุงูุฉ ุงูุงุชุตุงู
        function updateConnectionStatus() {
            const footerStats = document.getElementById('connectionStatus');
            if (footerStats) {
                if (isFirebaseConnected) {
                    footerStats.innerHTML = 'ูุธุงู ูุญูู + Firebase <span style="color: #4CAF50;">(ูุชุตู)</span>';
                } else {
                    footerStats.innerHTML = 'ูุธุงู ูุญูู + Firebase <span style="color: #f44336;">(ุบูุฑ ูุชุตู)</span>';
                }
            }
        }

        // ุชุญุฏูุซ ุงูุนูุงุตุฑ ุงูุญุฏูุซุฉ
        function updateRecentItems() {
            const container = document.getElementById('recentItemsGrid');
            if (!container) return;
            
            // ุฌูุน ุฌููุน ุงูุนูุงุตุฑ
            const allItems = [];
            Object.keys(portfolioData).forEach(subject => {
                portfolioData[subject].forEach(item => {
                    allItems.push({
                        ...item,
                        subject: subject
                    });
                });
            });
            
            // ุชุฑุชูุจ ุญุณุจ ุงูุชุงุฑูุฎ (ุงูุฃุญุฏุซ ุฃููุงู)
            allItems.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
            
            // ุฃุฎุฐ 6 ุนูุงุตุฑ ููุท
            const recentItems = allItems.slice(0, 6);
            
            // ูุณุญ ุงููุญุชูู ุงููุฏูู
            container.innerHTML = '';
            
            if (recentItems.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="fas fa-inbox"></i>
                        <h3>ูุง ุชูุฌุฏ ุนูุงุตุฑ ุญุฏูุซุฉ</h3>
                        <p>ุงุจุฏุฃ ุจุฅุถุงูุฉ ุนูุงุตุฑ ุฌุฏูุฏุฉ ุฅูู ููู ุงูุฅูุฌุงุฒ</p>
                    </div>
                `;
                return;
            }
            
            // ุฅุถุงูุฉ ุงูุนูุงุตุฑ ุงูุญุฏูุซุฉ
            recentItems.forEach(item => {
                const card = createItemCard(item, item.subject);
                container.appendChild(card);
            });
        }

        // ุชุจุฏูู ุงูุชุจููุจ
        function switchTab(tabId) {
            console.log(`๐ ุชุจุฏูู ุฅูู ุงูุชุจููุจ: ${tabId}`);
            
            // ุชุญุฏูุซ ุงูุชุจููุจุงุช ุงููุดุทุฉ
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
                if (tab.getAttribute('data-tab') === tabId) {
                    tab.classList.add('active');
                }
            });
            
            // ุชุญุฏูุซ ุงููุญุชูู
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.remove('active');
                if (content.id === tabId) {
                    content.classList.add('active');
                }
            });
            
            // ุชุญุฏูุซ ุนููุงู ุงูุตูุญุฉ
            const tabNames = {
                all: 'ุงูุฑุฆูุณูุฉ',
                arabic: 'ุงููุบุฉ ุงูุนุฑุจูุฉ',
                english: 'ุงูุฅูุฌููุฒูุฉ',
                quran: 'ุงููุฑุขู ุงููุฑูู',
                math: 'ุงูุฑูุงุถูุงุช',
                science: 'ุงูุนููู',
                activities: 'ุงููุดุงุทุงุช',
                manage: 'ุงูุฅุฏุงุฑุฉ'
            };
            
            document.title = `${tabNames[tabId] || tabId} - ููู ุฅูุฌุงุฒ ุงููุนููุฉ ูุฑูุงู`;
        }

        // ุชุญุฏูุซ ูุณู ูุนูู
        function updateSection(subject) {
            const container = document.getElementById(`${subject}Items`);
            if (!container) return;
            
            const items = portfolioData[subject] || [];
            
            // ูุณุญ ุงููุญุชูู ุงููุฏูู
            container.innerHTML = '';
            
            if (items.length === 0) {
                container.innerHTML = `
                    <div class="empty-state">
                        <i class="${getSubjectIcon(subject)}"></i>
                        <h3>ูุง ุชูุฌุฏ ุนูุงุตุฑ</h3>
                        <p>ูู ูุชู ุฅุถุงูุฉ ุฃู ุนูุงุตุฑ ุฅูู ูุฐุง ุงููุณู ุจุนุฏ</p>
                        <button class="btn btn-primary" onclick="addItem('${subject}')">
                            <i class="fas fa-plus"></i> ุฅุถุงูุฉ ุฃูู ุนูุตุฑ
                        </button>
                    </div>
                `;
                return;
            }
            
            // ุชุฑุชูุจ ุงูุนูุงุตุฑ (ุงูุฃุญุฏุซ ุฃููุงู)
            items.sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));
            
            // ุฅุถุงูุฉ ุงูุนูุงุตุฑ
            items.forEach(item => {
                const card = createItemCard(item, subject);
                container.appendChild(card);
            });
        }

        // ุฅูุดุงุก ุจุทุงูุฉ ุนูุตุฑ
        function createItemCard(item, subject) {
            const card = document.createElement('div');
            card.className = 'item-card';
            if (compactMode) card.classList.add('compact-mode');
            card.dataset.id = item.id;
            
            const title = item.letter || item.surah || item.concept || item.title || 'ุนูุตุฑ ุฌุฏูุฏ';
            const date = item.date || formatDate(new Date(item.timestamp || Date.now()));
            
            // ุงุณุชุฎุฏุงู ุตูุฑ ุงูุชุฑุงุถูุฉ ุฅุฐุง ูุงูุช ุงูุตูุฑ ูุงุฑุบุฉ
            const image1 = item.imageUrls && item.imageUrls[0] ? item.imageUrls[0] : getDefaultImage(subject, 1);
            const image2 = item.imageUrls && item.imageUrls[1] ? item.imageUrls[1] : getDefaultImage(subject, 2);
            
            card.innerHTML = `
                <div class="item-header">
                    <div class="item-title">${title}</div>
                    <div class="item-date">${date}</div>
                </div>
                <div class="item-body">
                    <div class="item-description">${item.description || 'ูุง ููุฌุฏ ูุตู'}</div>
                    <div class="item-images">
                        <div class="item-image" onclick="viewImage('${image1}')">
                            <img src="${image1}" alt="ุงูุตูุฑุฉ ุงูุฃููู" onerror="this.src='https://images.unsplash.com/photo-1513542789411-b6a5d4f31634?w=400&q=80'">
                        </div>
                        <div class="item-image" onclick="viewImage('${image2}')">
                            <img src="${image2}" alt="ุงูุตูุฑุฉ ุงูุซุงููุฉ" onerror="this.src='https://images.unsplash.com/photo-1513542789411-b6a5d4f31634?w=400&q=80'">
                        </div>
                    </div>
                    <div class="item-actions">
                        <button class="action-btn edit" onclick="editItem('${subject}', '${item.id}')">
                            <i class="fas fa-edit"></i> ุชุนุฏูู
                        </button>
                        <button class="action-btn delete" onclick="deleteItem('${subject}', '${item.id}')">
                            <i class="fas fa-trash"></i> ุญุฐู
                        </button>
                    </div>
                </div>
            `;
            
            return card;
        }

        // ุงูุญุตูู ุนูู ุตูุฑุฉ ุงูุชุฑุงุถูุฉ ุญุณุจ ุงููุณู
        function getDefaultImage(subject, index) {
            const defaultImages = {
                arabic: [
                    'https://images.unsplash.com/photo-1580582932707-520aed937b7b?w=400&q=80',
                    'https://images.unsplash.com/photo-1481627834876-b7833e8f5570?w=400&q=80'
                ],
                english: [
                    'https://images.unsplash.com/photo-1523580494863-6f3031224c94?w=400&q=80',
                    'https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=400&q=80'
                ],
                quran: [
                    'https://images.unsplash.com/photo-1511895426328-dc8714191300?w=400&q=80',
                    'https://images.unsplash.com/photo-1544716278-ca5e3f4abd8c?w=400&q=80'
                ],
                math: [
                    'https://images.unsplash.com/photo-1635070041078-e363dbe005cb?w=400&q=80',
                    'https://images.unsplash.com/photo-1596495578065-6e0763fa1178?w=400&q=80'
                ],
                science: [
                    'https://images.unsplash.com/photo-1532094349884-543bc11b234d?w=400&q=80',
                    'https://images.unsplash.com/photo-1532187863486-abf9dbad1b69?w=400&q=80'
                ],
                activities: [
                    'https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=400&q=80',
                    'https://images.unsplash.com/photo-1546410531-bb4caa6b424d?w=400&q=80'
                ]
            };
            
            return defaultImages[subject] ? defaultImages[subject][index - 1] : 
                   'https://images.unsplash.com/photo-1513542789411-b6a5d4f31634?w=400&q=80';
        }

        // ุงูุญุตูู ุนูู ุฃููููุฉ ุงููุงุฏุฉ
        function getSubjectIcon(subject) {
            const icons = {
                arabic: 'fas fa-book',
                english: 'fas fa-language',
                quran: 'fas fa-book-quran',
                math: 'fas fa-calculator',
                science: 'fas fa-flask',
                activities: 'fas fa-chalkboard-teacher',
                all: 'fas fa-home'
            };
            return icons[subject] || 'fas fa-file';
        }

        // ุฅุถุงูุฉ ุนูุตุฑ
        function addItem(subject) {
            console.log(`โ ุฅุถุงูุฉ ุนูุตุฑ ุฅูู: ${subject}`);
            
            currentSubject = subject;
            
            // ุชุญุฏูุฏ ุนููุงู ุงููููุฐุฌ
            const titles = {
                arabic: 'ุฅุถุงูุฉ ุญุฑู ุนุฑุจู',
                english: 'ุฅุถุงูุฉ ูููุฉ ุฅูุฌููุฒูุฉ',
                quran: 'ุฅุถุงูุฉ ุณูุฑุฉ ูุฑุขููุฉ',
                math: 'ุฅุถุงูุฉ ููููู ุฑูุงุถู',
                science: 'ุฅุถุงูุฉ ุชุฌุฑุจุฉ ุนูููุฉ',
                activities: 'ุฅุถุงูุฉ ูุดุงุท ูุฏุฑุณู'
            };
            
            document.getElementById('modalTitle').textContent = titles[subject] || 'ุฅุถุงูุฉ ุนูุตุฑ ุฌุฏูุฏ';
            document.getElementById('itemSubject').value = subject;
            
            // ูุณุญ ุงููููุฐุฌ
            document.getElementById('itemForm').reset();
            document.getElementById('preview1').innerHTML = '';
            document.getElementById('preview2').innerHTML = '';
            delete document.getElementById('itemForm').dataset.editId;
            delete document.getElementById('itemForm').dataset.editMode;
            
            // ุฅุธูุงุฑ ุงููููุฐุฌ
            document.getElementById('addModal').style.display = 'flex';
        }

        // ูุนุงููุฉ ุงูุตูุฑุฉ
        function previewImage(input, previewId) {
            const file = input.files[0];
            if (!file) return;
            
            // ุงูุชุญูู ูู ุญุฌู ุงูุตูุฑุฉ (5MB ูุญุฏ ุฃูุตู)
            if (file.size > 5 * 1024 * 1024) {
                showToast('ุญุฌู ุงูุตูุฑุฉ ูุจูุฑ ุฌุฏุงู (ุงูุญุฏ ุงูุฃูุตู 5MB)', 'error');
                input.value = '';
                return;
            }
            
            // ุงูุชุญูู ูู ููุน ุงูุตูุฑุฉ
            if (!file.type.match('image.*')) {
                showToast('ุงูุฑุฌุงุก ุงุฎุชูุงุฑ ููู ุตูุฑุฉ ููุท', 'error');
                input.value = '';
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const preview = document.getElementById(previewId);
                preview.innerHTML = `<img src="${e.target.result}" alt="ูุนุงููุฉ ุงูุตูุฑุฉ">`;
            };
            reader.readAsDataURL(file);
        }

        // ุชุนุฏูู ุงูุนูุตุฑ
        async function editItem(subject, itemId) {
            console.log(`โ๏ธ ุชุนุฏูู ุงูุนูุตุฑ: ${itemId}`);
            
            const item = portfolioData[subject].find(i => i.id === itemId);
            if (!item) {
                showToast('ุงูุนูุตุฑ ุบูุฑ ููุฌูุฏ', 'error');
                return;
            }
            
            currentSubject = subject;
            
            // ุชุนุจุฆุฉ ุงููููุฐุฌ
            document.getElementById('modalTitle').textContent = 'ุชุนุฏูู ุงูุนูุตุฑ';
            document.getElementById('itemSubject').value = subject;
            document.getElementById('itemName').value = item.letter || item.surah || item.concept || item.title || '';
            document.getElementById('itemDesc').value = item.description || '';
            
            // ูุณุญ ูุนุงููุงุช ุงูุตูุฑ ุงููุฏููุฉ
            document.getElementById('preview1').innerHTML = '';
            document.getElementById('preview2').innerHTML = '';
            
            // ุฅุถุงูุฉ ูุนุงููุงุช ููุตูุฑ ุงูููุฌูุฏุฉ
            if (item.imageUrls && item.imageUrls[0]) {
                document.getElementById('preview1').innerHTML = `<img src="${item.imageUrls[0]}" alt="ุงูุตูุฑุฉ ุงูุญุงููุฉ">`;
            }
            
            if (item.imageUrls && item.imageUrls[1]) {
                document.getElementById('preview2').innerHTML = `<img src="${item.imageUrls[1]}" alt="ุงูุตูุฑุฉ ุงูุญุงููุฉ">`;
            }
            
            // ุฅุธูุงุฑ ุงููููุฐุฌ
            document.getElementById('addModal').style.display = 'flex';
            
            // ุญูุธ ูุนุฑู ุงูุนูุตุฑ ูููููุฐุฌ
            document.getElementById('itemForm').dataset.editId = itemId;
            document.getElementById('itemForm').dataset.editMode = 'true';
        }

        // ุญุฐู ุงูุนูุตุฑ
        async function deleteItem(subject, itemId) {
            console.log(`๐๏ธ ุญุฐู ุงูุนูุตุฑ: ${itemId}`);
            
            if (!confirm('ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุนูุตุฑุ ูุง ูููู ุงูุชุฑุงุฌุน ุนู ูุฐู ุงูุนูููุฉ.')) {
                return;
            }
            
            try {
                showToast('ุฌุงุฑู ุญุฐู ุงูุนูุตุฑ...', 'info');
                
                // ุญุฐู ูู Firebase
                if (window.firebaseDb) {
                    try {
                        await window.firebaseDb.collection('portfolio_items').doc(itemId).delete();
                    } catch (firebaseError) {
                        console.warn('โ๏ธ ูุดู ุญุฐู ูู Firebase:', firebaseError.message);
                    }
                }
                
                // ุญุฐู ูู ุงูุจูุงูุงุช ุงููุญููุฉ
                portfolioData[subject] = portfolioData[subject].filter(item => item.id !== itemId);
                
                // ุญูุธ ูู ุงูุชุฎุฒูู ุงููุญูู
                saveToLocalStorage();
                
                console.log(`โ ุชู ุญุฐู ุงูุนูุตุฑ: ${itemId}`);
                
                // ุชุญุฏูุซ ุงููุงุฌูุฉ
                updateDashboard();
                updateSection(subject);
                updateStorageInfo();
                
                showToast('ุชู ุญุฐู ุงูุนูุตุฑ ุจูุฌุงุญ', 'success');
                
            } catch (error) {
                console.error('โ ุฎุทุฃ ูู ุญุฐู ุงูุนูุตุฑ:', error);
                showToast('ุญุฏุซ ุฎุทุฃ ูู ุญุฐู ุงูุนูุตุฑ', 'error');
            }
        }

        // ุฅุบูุงู ุงููููุฐุฌ
        function closeModal() {
            document.getElementById('addModal').style.display = 'none';
            document.getElementById('itemForm').reset();
            document.getElementById('preview1').innerHTML = '';
            document.getElementById('preview2').innerHTML = '';
            delete document.getElementById('itemForm').dataset.editId;
            delete document.getElementById('itemForm').dataset.editMode;
        }

        // ุนุฑุถ ุงูุตูุฑุฉ
        function viewImage(url) {
            if (!url) return;
            
            document.getElementById('modalImageView').src = url;
            document.getElementById('imageModal').style.display = 'flex';
        }

        // ุฅุบูุงู ูุงูุฐุฉ ุงูุตูุฑุฉ
        function closeImageModal() {
            document.getElementById('imageModal').style.display = 'none';
        }

        // ุทุจุงุนุฉ ุงูููู
        function printPortfolio() {
            console.log('๐จ๏ธ ุฌุงุฑู ุชุญุถูุฑ ุงูุทุจุงุนุฉ...');
            
            // ุญูุธ HTML ุงูุญุงูู
            const originalHTML = document.body.innerHTML;
            
            // ุฅูุดุงุก ูุญุชูู ููุทุจุงุนุฉ
            let printContent = `
                <html dir="rtl">
                <head>
                    <title>ููู ุฅูุฌุงุฒ ุงููุนููุฉ ูุฑูุงู ุงูุบูุงุฑู</title>
                    <style>
                        body { font-family: 'Tajawal', sans-serif; padding: 20px; }
                        .print-header { text-align: center; margin-bottom: 30px; border-bottom: 3px solid #333; padding-bottom: 20px; }
                        .print-section { margin-bottom: 40px; page-break-inside: avoid; }
                        .print-item { border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 10px; }
                        .print-images { display: flex; gap: 10px; margin-top: 10px; flex-wrap: wrap; }
                        .print-images img { max-width: 200px; max-height: 150px; object-fit: cover; border: 1px solid #ddd; }
                        @page { margin: 2cm; }
                        @media print {
                            .no-print { display: none; }
                        }
                    </style>
                </head>
                <body>
                    <div class="print-header">
                        <h1>ููู ุฅูุฌุงุฒ ุงููุนููุฉ</h1>
                        <h2>ูุฑูุงู ุนุจุฏุงููู ุงูุบูุงุฑู</h2>
                        <p>ุงุจุชุฏุงุฆูุฉ ุงููุฎุจุฉ - ุงูุนุงู ุงูุฏุฑุงุณู ูกูคูคูฅ-ูกูคูคูฆ ูู</p>
                        <p>ุชุงุฑูุฎ ุงูุทุจุงุนุฉ: ${new Date().toLocaleDateString('ar-SA')}</p>
                    </div>
            `;
            
            // ุฅุถุงูุฉ ูู ูุณู
            Object.keys(portfolioData).forEach(subject => {
                const items = portfolioData[subject];
                if (items.length > 0) {
                    const subjectNames = {
                        arabic: 'ุงููุบุฉ ุงูุนุฑุจูุฉ',
                        english: 'ุงููุบุฉ ุงูุฅูุฌููุฒูุฉ',
                        quran: 'ุงููุฑุขู ุงููุฑูู',
                        math: 'ุงูุฑูุงุถูุงุช',
                        science: 'ุงูุนููู',
                        activities: 'ุงููุดุงุทุงุช ุงููุฏุฑุณูุฉ'
                    };
                    
                    printContent += `
                        <div class="print-section">
                            <h3 style="color: #4361ee; border-bottom: 2px solid #4361ee; padding-bottom: 10px;">
                                ${subjectNames[subject]}
                            </h3>
                    `;
                    
                    items.forEach(item => {
                        const title = item.letter || item.surah || item.concept || item.title || 'ุนูุตุฑ';
                        printContent += `
                            <div class="print-item">
                                <h4>${title}</h4>
                                <p><strong>ุงูุชุงุฑูุฎ:</strong> ${item.date || 'ุบูุฑ ูุญุฏุฏ'}</p>
                                <p><strong>ุงููุตู:</strong> ${item.description || 'ูุง ููุฌุฏ ูุตู'}</p>
                                ${item.imageUrls && item.imageUrls.length > 0 ? `
                                    <div class="print-images">
                                        ${item.imageUrls.map((img, index) => 
                                            `<img src="${img}" alt="ุงูุตูุฑุฉ ${index + 1}" onerror="this.style.display='none'">`
                                        ).join('')}
                                    </div>
                                ` : ''}
                            </div>
                        `;
                    });
                    
                    printContent += `</div>`;
                }
            });
            
            printContent += `
                    <div class="no-print" style="text-align: center; margin-top: 50px;">
                        <button onclick="window.print()" style="padding: 10px 30px; background: #4361ee; color: white; border: none; border-radius: 5px; cursor: pointer;">
                            ุทุจุงุนุฉ
                        </button>
                        <button onclick="window.close()" style="padding: 10px 30px; background: #666; color: white; border: none; border-radius: 5px; margin-right: 10px; cursor: pointer;">
                            ุฅุบูุงู
                        </button>
                    </div>
                </body>
                </html>
            `;
            
            // ูุชุญ ูุงูุฐุฉ ุงูุทุจุงุนุฉ
            const printWindow = window.open('', '_blank');
            printWindow.document.write(printContent);
            printWindow.document.close();
            
            showToast('ุชู ุชุญุถูุฑ ููู ุงูุทุจุงุนุฉ', 'success');
        }

        // ุชูุณูู ุงูุชุงุฑูุฎ
        function formatDate(date) {
            return date.toLocaleDateString('ar-SA', {
                year: 'numeric',
                month: 'long',
                day: 'numeric'
            });
        }

        // ุนุฑุถ ุงูุฅุดุนุงุฑุงุช
        function showToast(message, type = 'info') {
            // ุฅูุดุงุก ุนูุตุฑ ุงูุฅุดุนุงุฑ
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            const icons = {
                success: 'fas fa-check-circle',
                error: 'fas fa-exclamation-circle',
                info: 'fas fa-info-circle'
            };
            
            toast.innerHTML = `
                <i class="${icons[type] || 'fas fa-info-circle'}"></i>
                <div class="toast-content">
                    <div class="toast-title">${type === 'success' ? 'ูุฌุงุญ' : type === 'error' ? 'ุฎุทุฃ' : 'ูุนูููุฉ'}</div>
                    <div class="toast-message">${message}</div>
                </div>
                <button class="toast-close" onclick="this.parentElement.remove()">
                    <i class="fas fa-times"></i>
                </button>
            `;
            
            // ุฅุถุงูุฉ ุฅูู ุงูุตูุญุฉ
            document.body.appendChild(toast);
            
            // ุฅุฒุงูุชู ุชููุงุฆูุงู ุจุนุฏ 5 ุซูุงูู
            setTimeout(() => {
                if (toast.parentNode) {
                    toast.remove();
                }
            }, 5000);
        }

        // ุงุฎุชูุงุฑ ุงููุณู ููุฅุถุงูุฉ
        function showSubjectSelection() {
            const modal = document.createElement('div');
            modal.className = 'modal';
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.8);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 2000;
                backdrop-filter: blur(5px);
            `;
            
            modal.innerHTML = `
                <div style="
                    background: white;
                    border-radius: 15px;
                    padding: 40px;
                    max-width: 500px;
                    width: 90%;
                    text-align: center;
                ">
                    <h3 style="margin-bottom: 30px; color: #333;">ุงุฎุชุฑ ุงููุณู</h3>
                    <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 15px;">
                        <button onclick="addItem('arabic'); this.closest('.modal').remove()" style="
                            padding: 20px;
                            background: linear-gradient(135deg, #ff9a9e 0%, #fad0c4 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 1.1rem;
                            cursor: pointer;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            gap: 10px;
                        ">
                            <i class="fas fa-book"></i>
                            <span>ุงูุนุฑุจูุฉ</span>
                        </button>
                        
                        <button onclick="addItem('english'); this.closest('.modal').remove()" style="
                            padding: 20px;
                            background: linear-gradient(135deg, #a18cd1 0%, #fbc2eb 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 1.1rem;
                            cursor: pointer;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            gap: 10px;
                        ">
                            <i class="fas fa-language"></i>
                            <span>ุงูุฅูุฌููุฒูุฉ</span>
                        </button>
                        
                        <button onclick="addItem('quran'); this.closest('.modal').remove()" style="
                            padding: 20px;
                            background: linear-gradient(135deg, #fad0c4 0%, #ffd1ff 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 1.1rem;
                            cursor: pointer;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            gap: 10px;
                        ">
                            <i class="fas fa-book-quran"></i>
                            <span>ุงููุฑุขู</span>
                        </button>
                        
                        <button onclick="addItem('math'); this.closest('.modal').remove()" style="
                            padding: 20px;
                            background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 1.1rem;
                            cursor: pointer;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            gap: 10px;
                        ">
                            <i class="fas fa-calculator"></i>
                            <span>ุงูุฑูุงุถูุงุช</span>
                        </button>
                        
                        <button onclick="addItem('science'); this.closest('.modal').remove()" style="
                            padding: 20px;
                            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 1.1rem;
                            cursor: pointer;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            gap: 10px;
                        ">
                            <i class="fas fa-flask"></i>
                            <span>ุงูุนููู</span>
                        </button>
                        
                        <button onclick="addItem('activities'); this.closest('.modal').remove()" style="
                            padding: 20px;
                            background: linear-gradient(135deg, #d4fc79 0%, #96e6a1 100%);
                            border: none;
                            border-radius: 10px;
                            color: white;
                            font-size: 1.1rem;
                            cursor: pointer;
                            display: flex;
                            flex-direction: column;
                            align-items: center;
                            gap: 10px;
                        ">
                            <i class="fas fa-chalkboard-teacher"></i>
                            <span>ุงููุดุงุทุงุช</span>
                        </button>
                    </div>
                    <button onclick="this.closest('.modal').remove()" style="
                        margin-top: 30px;
                        padding: 10px 30px;
                        background: #f1f3f5;
                        border: none;
                        border-radius: 8px;
                        color: #666;
                        cursor: pointer;
                        font-size: 1rem;
                    ">
                        ุฅูุบุงุก
                    </button>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        // ุฌุนู ุงูุฏูุงู ูุชุงุญุฉ ุนุงูููุงู
        window.switchTab = switchTab;
        window.addItem = addItem;
        window.closeModal = closeModal;
        window.closeImageModal = closeImageModal;
        window.saveItem = saveItem;
        window.editItem = editItem;
        window.deleteItem = deleteItem;
        window.viewImage = viewImage;
        window.printPortfolio = printPortfolio;
        window.showSubjectSelection = showSubjectSelection;
        window.exportData = exportData;
        window.importData = importData;
        window.clearAllData = clearAllData;
        window.clearLocalStorage = clearLocalStorage;
        window.toggleCompactMode = toggleCompactMode;

        console.log('๐ ุงููุธุงู ุฌุงูุฒ! ูุณุฎุฉ 2.0');
    </script>
</body>
</html>
